<UserControl x:Class="Shedule.Controls.MainScheduleItemControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:s="clr-namespace:System;assembly=mscorlib"
             xmlns:local="clr-namespace:Shedule.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" Grid.Row="2" Grid.Column="1">
    <UserControl.Resources>
        <local:FirstLetterFromStrConverter x:Key="FirstLetterFromStrConverter"/>
    </UserControl.Resources>
    <StackPanel x:Name="StackPanel" x:FieldModifier="public">
        <ComboBox SelectedValue ="{Binding TeachingId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="10,0" IsEditable = "False" FontSize = "18" Height = "50" FontFamily = "Global User Interface" SelectedValuePath = "Teaching.Id">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <StackPanel>
                            <TextBlock>
                                <TextBlock.Text>
                                    <MultiBinding  StringFormat="{}{0} {1} {2}. {3}." TargetNullValue="Нет пары">
                                        <Binding Path="Teaching.SpecialitySubject.Subject.Name"/>
                                        <Binding Path="Teaching.Teacher.Surname"/>
                                        <Binding Path="Teaching.Teacher.Name" Converter="{StaticResource FirstLetterFromStrConverter}"/>
                                        <Binding Path="Teaching.Teacher.Patronymic" Converter="{StaticResource FirstLetterFromStrConverter}"/>
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <ItemsControl BorderBrush="white" ItemsSource = "{Binding MainSchedulesInTheSameTime}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation = "Horizontal">
                                            <TextBlock>
                                            <Run Text="{Binding Teaching.SpecialitySubject.Subject.Name, StringFormat='{}{0} - '}"/>
                                            <Run Text="{Binding Teaching.Teacher.Surname}"/>
                                            <Run Text="{Binding Teaching.Teacher.Name, Converter={StaticResource FirstLetterFromStrConverter}, StringFormat='{}{0}. '}"/>
                                            <Run Text="{Binding Teaching.Teacher.Patronymic, Converter={StaticResource FirstLetterFromStrConverter}, StringFormat='{}{0}. '}"/>
                                            </TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl >
                        </StackPanel>
                        <StackPanel>
                            <Image Margin="10,0,0,0" Width="20" Height="20">
                                <Image.Style>
                                    <Style TargetType="{x:Type Image}">
                                        <Setter Property="Source" Value="/Image\bad.png"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RecommendationLevel}" Value="0">
                                                <Setter Property="Source" Value="/Image\good.png"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Image.Style>
                            </Image>
                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <ComboBox 
            SelectedValue ="{Binding ClassroomId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
            Padding="0" 
            SelectedValuePath = "Classroom.Id" 
            IsEditable="False" 
            MinWidth = "60" 
            FontSize = "18" 
            Height = "20" 
            Margin = "0" 
            FontFamily = "Global User Interface" 
            HorizontalContentAlignment = "Center" 
            VerticalContentAlignment = "Center" 
            HorizontalAlignment = "Center">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <StackPanel Orientation="Vertical">
                            <TextBlock>
                                <TextBlock.Text>
                                    <MultiBinding  StringFormat="{}{0} {1}" TargetNullValue="X">
                                        <Binding Path="Classroom.Number"/>
                                        <Binding Path="Classroom.Building"/>
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <ItemsControl BorderBrush="white" ItemsSource = "{Binding MainSchedulesInTheSameClassroom}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation = "Horizontal">
                                            <TextBlock>
                                                <TextBlock.Text>
                                                    <MultiBinding  StringFormat="{}{0} {1}" TargetNullValue="Не выбрано">
                                                        <Binding Path="Teaching.SpecialitySubject.Subject.Name"/>
                                                        <Binding Path="Teaching.Group.Codename"/>
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl >
                        </StackPanel>
                        <Image Margin="10,0,0,0" Width="20" Height="20">
                            <Image.Style>
                                <Style TargetType="{x:Type Image}">
                                    <Setter Property="Source" Value="/Image\bad.png"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RecommendationLevel}" Value="0">
                                            <Setter Property="Source" Value="/Image\good.png"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding RecommendationLevel}" Value="1">
                                            <Setter Property="Source" Value="{x:Null}"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Image.Style>
                        </Image>
                    </StackPanel>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
    </StackPanel>
</UserControl>
